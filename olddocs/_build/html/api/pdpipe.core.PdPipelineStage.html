
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>PdPipelineStage &#8212; pdpipe  documentation</title>
    <link rel="stylesheet" href="../_static/graphite.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="PdPipeline" href="pdpipe.core.PdPipeline.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pdpipe.core.PdPipeline.html" title="PdPipeline"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pdpipe  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pdpipelinestage">
<h1>PdPipelineStage<a class="headerlink" href="#pdpipelinestage" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pdpipe.core.PdPipelineStage">
<em class="property">class </em><code class="sig-prename descclassname">pdpipe.core.</code><code class="sig-name descname">PdPipelineStage</code><span class="sig-paren">(</span><em class="sig-param">exraise=True</em>, <em class="sig-param">exmsg=None</em>, <em class="sig-param">appmsg=None</em>, <em class="sig-param">desc=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pdpipe.core.PdPipelineStage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>A stage of a pandas DataFrame-processing pipeline.</p>
<dl class="simple">
<dt>exraise<span class="classifier">bool, default True</span></dt><dd><p>If true, a pdpipe.FailedPreconditionError is raised when this
stage is applied to a dataframe for which the precondition does
not hold. Otherwise the stage is skipped.</p>
</dd>
<dt>exmsg<span class="classifier">str, default None</span></dt><dd><p>The message of the exception that is raised on a failed
precondition if exraise is set to True. A default message is used
if None is given.</p>
</dd>
<dt>appmsg<span class="classifier">str, default None</span></dt><dd><p>The message printed when this stage is applied with verbose=True.
A default message is used if None is given.</p>
</dd>
<dt>desc<span class="classifier">str, default None</span></dt><dd><p>A short description of this stage, used as its string representation.
A default description is used if None is given.</p>
</dd>
</dl>
<p class="rubric">Methods Summary</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.AdHocStage" title="pdpipe.core.PdPipelineStage.AdHocStage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AdHocStage</span></code></a>(transform[, prec])</p></td>
<td><p>Creates and adds an ad-hoc stage of a pandas DataFrame-processing pipeline to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.AggByCols" title="pdpipe.core.PdPipelineStage.AggByCols"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AggByCols</span></code></a>(columns, func[, result_columns, …])</p></td>
<td><p>Creates and adds a pipeline stage applying a series-wise function to columns to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.ApplyByCols" title="pdpipe.core.PdPipelineStage.ApplyByCols"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ApplyByCols</span></code></a>(columns, func[, result_columns, …])</p></td>
<td><p>Creates and adds a pipeline stage applying an element-wise function to columns to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.ApplyToRows" title="pdpipe.core.PdPipelineStage.ApplyToRows"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ApplyToRows</span></code></a>(func[, colname, follow_column, …])</p></td>
<td><p>Creates and adds a pipeline stage generating columns by applying a function to each row to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.Bin" title="pdpipe.core.PdPipelineStage.Bin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bin</span></code></a>(bin_map[, drop])</p></td>
<td><p>Creates and adds a pipeline stage that adds a binned version of a column or columns to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.ColByFrameFunc" title="pdpipe.core.PdPipelineStage.ColByFrameFunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ColByFrameFunc</span></code></a>(column, func[, …])</p></td>
<td><p>Creates and adds a pipeline stage adding a column by applying a dataframw-wide function to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.ColDrop" title="pdpipe.core.PdPipelineStage.ColDrop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ColDrop</span></code></a>(columns[, errors])</p></td>
<td><p>Creates and adds a pipeline stage that drops columns by name to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.ColRename" title="pdpipe.core.PdPipelineStage.ColRename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ColRename</span></code></a>(rename_map, **kwargs)</p></td>
<td><p>Creates and adds a pipeline stage that renames a column or columns to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.ColReorder" title="pdpipe.core.PdPipelineStage.ColReorder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ColReorder</span></code></a>(positions, **kwargs)</p></td>
<td><p>Creates and adds a pipeline stage that reorders columns to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.DropNa" title="pdpipe.core.PdPipelineStage.DropNa"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DropNa</span></code></a>(**kwargs)</p></td>
<td><p>Creates and adds a pipeline stage that drops null values to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.DropRareTokens" title="pdpipe.core.PdPipelineStage.DropRareTokens"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DropRareTokens</span></code></a>(columns, threshold[, drop])</p></td>
<td><p>Creates and adds a pipeline stage that drop rare tokens from token lists to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.Encode" title="pdpipe.core.PdPipelineStage.Encode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Encode</span></code></a>([columns, exclude_columns, drop])</p></td>
<td><p>Creates and adds a pipeline stage that encodes categorical columns to integer values to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.FreqDrop" title="pdpipe.core.PdPipelineStage.FreqDrop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FreqDrop</span></code></a>(threshold, column, **kwargs)</p></td>
<td><p>Creates and adds a pipeline stage that drops rows by value frequency to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.Log" title="pdpipe.core.PdPipelineStage.Log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Log</span></code></a>([columns, exclude, drop, non_neg, …])</p></td>
<td><p>Creates and adds a pipeline stage that log-transforms numeric data to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.MapColVals" title="pdpipe.core.PdPipelineStage.MapColVals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MapColVals</span></code></a>(columns, value_map[, …])</p></td>
<td><p>Creates and adds a pipeline stage that replaces the values of a column by a map to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.OneHotEncode" title="pdpipe.core.PdPipelineStage.OneHotEncode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OneHotEncode</span></code></a>([columns, dummy_na, …])</p></td>
<td><p>Creates and adds a pipeline stage that one-hot-encodes categorical columns to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.PdPipeline" title="pdpipe.core.PdPipelineStage.PdPipeline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PdPipeline</span></code></a>(stages[, transformer_getter])</p></td>
<td><p>Creates and adds a pipeline for processing pandas DataFrame objects to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.RemoveStopwords" title="pdpipe.core.PdPipelineStage.RemoveStopwords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RemoveStopwords</span></code></a>(language, columns[, drop])</p></td>
<td><p>Creates and adds a pipeline stage that removes stopwords from a tokenized list to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.RowDrop" title="pdpipe.core.PdPipelineStage.RowDrop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RowDrop</span></code></a>(conditions[, reduce, columns])</p></td>
<td><p>Creates and adds a pipeline stage that drop rows by callable conditions to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.Scale" title="pdpipe.core.PdPipelineStage.Scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Scale</span></code></a>(scaler[, exclude_columns, …])</p></td>
<td><p>Creates and adds a pipeline stage that scales data to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.SnowballStem" title="pdpipe.core.PdPipelineStage.SnowballStem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SnowballStem</span></code></a>(stemmer_name, columns[, drop])</p></td>
<td><p>Creates and adds a pipeline stage that stems words in a list using the Snowball stemmer to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.TokenizeWords" title="pdpipe.core.PdPipelineStage.TokenizeWords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TokenizeWords</span></code></a>(columns[, drop])</p></td>
<td><p>Creates and adds a pipeline stage that tokenize a sentence into words by whitespaces to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.UntokenizeWords" title="pdpipe.core.PdPipelineStage.UntokenizeWords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UntokenizeWords</span></code></a>(columns[, drop])</p></td>
<td><p>Creates and adds a pipeline stage that joins token lists to whitespace-seperated strings to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.ValDrop" title="pdpipe.core.PdPipelineStage.ValDrop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValDrop</span></code></a>(values[, columns])</p></td>
<td><p>Creates and adds a pipeline stage that drops rows by value to this pipeline stage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.ValKeep" title="pdpipe.core.PdPipelineStage.ValKeep"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValKeep</span></code></a>(values[, columns])</p></td>
<td><p>Creates and adds a pipeline stage that keeps rows by value to this pipeline stage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pdpipe.core.PdPipelineStage.__call__" title="pdpipe.core.PdPipelineStage.__call__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code></a>(df[, exraise, verbose])</p></td>
<td><p>Applies this pipeline stage to the given dataframe.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.apply" title="pdpipe.core.PdPipelineStage.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code></a>(df[, exraise, verbose])</p></td>
<td><p>Applies this pipeline stage to the given dataframe.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.description" title="pdpipe.core.PdPipelineStage.description"><code class="xref py py-obj docutils literal notranslate"><span class="pre">description</span></code></a>()</p></td>
<td><p>Returns the description of this pipeline stage</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.fit" title="pdpipe.core.PdPipelineStage.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(X[, y, exraise, verbose])</p></td>
<td><p>Fits this stage without transforming the given dataframe.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.fit_transform" title="pdpipe.core.PdPipelineStage.fit_transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_transform</span></code></a>(X[, y, exraise, verbose])</p></td>
<td><p>Fits this stage and transforms the given dataframe.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../index.html#pdpipe.core.PdPipelineStage.transform" title="pdpipe.core.PdPipelineStage.transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform</span></code></a>(X[, y, exraise, verbose])</p></td>
<td><p>Transforms the given dataframe without fitting this stage.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Documentation</p>
<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.AdHocStage">
<code class="sig-name descname">AdHocStage</code><span class="sig-paren">(</span><em class="sig-param">transform</em>, <em class="sig-param">prec=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.AdHocStage" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds an ad-hoc stage of a pandas DataFrame-processing pipeline to this pipeline stage.</p>
<dl class="simple">
<dt>transform<span class="classifier">callable</span></dt><dd><p>The transformation this stage applies to dataframes.</p>
</dd>
<dt>prec<span class="classifier">callable, default None</span></dt><dd><p>A callable that returns a boolean value. Represent a a precondition
used to determine whether this stage can be applied to a given
dataframe. If None is given, set to a function always returning True.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.AggByCols">
<code class="sig-name descname">AggByCols</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">func</em>, <em class="sig-param">result_columns=None</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">func_desc=None</em>, <em class="sig-param">suffix=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.AggByCols" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage applying a series-wise function to columns to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Names of columns on which to apply the given function.</p>
</dd>
<dt>func<span class="classifier">function</span></dt><dd><p>The function to be applied to each element of the given columns.</p>
</dd>
<dt>result_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>The names of the new columns resulting from the mapping operation. Must
be of the same length as columns. If None, behavior depends on the
drop parameter: If drop is True, the name of the source column is used;
otherwise, the name of the source column is used with a defined suffix.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, source columns are dropped after being mapped.</p>
</dd>
<dt>func_desc<span class="classifier">str, default None</span></dt><dd><p>A function description of the given function; e.g. ‘normalizing revenue
by company size’. A default description is used if None is given.</p>
</dd>
<dt>suffix<span class="classifier">str, optional</span></dt><dd><p>The suffix to add to resulting columns in case where results_columns
is None and drop is set to False. Of not given, defaults to ‘_agg’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;acd&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;lbl&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_ph</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ApplyByCols</span><span class="p">(</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_ph</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">         ph  lbl</span>
<span class="go">1  1.163151  acd</span>
<span class="go">2  1.974081  alk</span>
<span class="go">3  2.493205  alk</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.ApplyByCols">
<code class="sig-name descname">ApplyByCols</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">func</em>, <em class="sig-param">result_columns=None</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">func_desc=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.ApplyByCols" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage applying an element-wise function to columns to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Names of columns on which to apply the given function.</p>
</dd>
<dt>func<span class="classifier">function</span></dt><dd><p>The function to be applied to each element of the given columns.</p>
</dd>
<dt>result_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>The names of the new columns resulting from the mapping operation. Must
be of the same length as columns. If None, behavior depends on the
drop parameter: If drop is True, the name of the source column is used;
otherwise, the name of the source column is used with the suffix
‘_app’.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, source columns are dropped after being mapped.</p>
</dd>
<dt>func_desc<span class="classifier">str, default None</span></dt><dd><p>A function description of the given function; e.g. ‘normalizing revenue
by company size’. A default description is used if None is given.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">math</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;acd&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;lbl&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_ph</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ApplyByCols</span><span class="p">(</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_ph</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   ph  lbl</span>
<span class="go">1   4  acd</span>
<span class="go">2   8  alk</span>
<span class="go">3  13  alk</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.ApplyToRows">
<code class="sig-name descname">ApplyToRows</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">colname=None</em>, <em class="sig-param">follow_column=None</em>, <em class="sig-param">func_desc=None</em>, <em class="sig-param">prec=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.ApplyToRows" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage generating columns by applying a function to each row to this pipeline stage.</p>
<dl class="simple">
<dt>func<span class="classifier">function</span></dt><dd><p>The function to be applied to each row of the processed DataFrame.</p>
</dd>
<dt>colname<span class="classifier">single label, default None</span></dt><dd><p>The label of the new column resulting from the function application. If
None, ‘new_col’ is used. Ignored if a DataFrame is generated by the
function (i.e. each row generates a Series rather than a value), in
which case the laebl of each column in the resulting DataFrame is used.</p>
</dd>
<dt>follow_column<span class="classifier">str, default None</span></dt><dd><p>Resulting columns will be inserted after this column. If None, new
columns are inserted at the end of the processed DataFrame.</p>
</dd>
<dt>func_desc<span class="classifier">str, default None</span></dt><dd><p>A function description of the given function; e.g. ‘normalizing revenue
by company size’. A default description is used if None is given.</p>
</dd>
<dt>prec<span class="classifier">function, default None</span></dt><dd><p>A function taking a DataFrame, returning True if it this stage is
applicable to the given DataFrame. If None is given, a function always
returning True is used.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2143</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1321</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1255</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;years&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_revenue&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_rev</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;years&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;avg_revenue&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_total_rev</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ApplyToRows</span><span class="p">(</span><span class="n">total_rev</span><span class="p">,</span> <span class="s1">&#39;total_revenue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_total_rev</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   years  avg_revenue  total_revenue</span>
<span class="go">1      3         2143           6429</span>
<span class="go">2     10         1321          13210</span>
<span class="go">3      7         1255           8785</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">halfer</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">new</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year/2&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;years&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rev/2&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;avg_revenue&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">}</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_cols</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ApplyToRows</span><span class="p">(</span><span class="n">halfer</span><span class="p">,</span> <span class="n">follow_column</span><span class="o">=</span><span class="s1">&#39;years&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_cols</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   years   rev/2  year/2  avg_revenue</span>
<span class="go">1      3  1071.5     1.5         2143</span>
<span class="go">2     10   660.5     5.0         1321</span>
<span class="go">3      7   627.5     3.5         1255</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.Bin">
<code class="sig-name descname">Bin</code><span class="sig-paren">(</span><em class="sig-param">bin_map</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.Bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that adds a binned version of a column or columns to this pipeline stage.</p>
<p>If drop is set to True the new columns retain the names of the source
columns; otherwise, the resulting column gain the suffix ‘_bin’</p>
<dl class="simple">
<dt>bin_map<span class="classifier">dict</span></dt><dd><p>Maps column labels to bin arrays. The bin array is interpreted as
containing start points of consecutive bins, except for the final
point, assumed to be the end point of the last bin. Additionally, a
bin array implicitly projects a left-most bin containing all elements
smaller than the left-most end point and a right-most bin containing
all elements larger that the right-most end point. For example, the
list [0, 5, 8] is interpreted as the bins (-∞, 0),
[0-5), [5-8) and [8, ∞).</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being binned.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;speed&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">Bin</span><span class="p">({</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]},</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   speed speed_bin</span>
<span class="go">1     -3        &lt;5</span>
<span class="go">2      4        &lt;5</span>
<span class="go">3      5        5≤</span>
<span class="go">4      9        5≤</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">Bin</span><span class="p">({</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">]},</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   speed speed_bin</span>
<span class="go">1     -3        &lt;0</span>
<span class="go">2      4       0-5</span>
<span class="go">3      5       5-8</span>
<span class="go">4      9        8≤</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.ColByFrameFunc">
<code class="sig-name descname">ColByFrameFunc</code><span class="sig-paren">(</span><em class="sig-param">column</em>, <em class="sig-param">func</em>, <em class="sig-param">follow_column=None</em>, <em class="sig-param">func_desc=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.ColByFrameFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage adding a column by applying a dataframw-wide function to this pipeline stage.</p>
<dl class="simple">
<dt>column<span class="classifier">str</span></dt><dd><p>The name of the resulting column.</p>
</dd>
<dt>func<span class="classifier">function</span></dt><dd><p>The function to be applied to the input dataframe. The function should
return a pandas.Series object.</p>
</dd>
<dt>follow_column<span class="classifier">str, default None</span></dt><dd><p>Resulting columns will be inserted after this column. If None, new
columns are inserted at the end of the processed DataFrame.</p>
</dd>
<dt>func_desc<span class="classifier">str, default None</span></dt><dd><p>A function description of the given function; e.g. ‘normalizing revenue
by company size’. A default description is used if None is given.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_equal</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ColByFrameFunc</span><span class="p">(</span><span class="s2">&quot;A==B&quot;</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_equal</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   A  B   A==B</span>
<span class="go">1  3  3   True</span>
<span class="go">2  2  4  False</span>
<span class="go">3  1  5  False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.ColDrop">
<code class="sig-name descname">ColDrop</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">errors=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.ColDrop" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that drops columns by name to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str, iterable or callable</span></dt><dd><p>The label, or an iterable of labels, of columns to drop. Alternatively,
columns can be assigned a callable returning bool values for
pandas.Series objects; if this is the case, every column for which it
return True will be dropped.</p>
</dd>
<dt>errors<span class="classifier">{‘ignore’, ‘raise’}, default ‘raise’</span></dt><dd><p>If ‘ignore’, suppress error and existing labels are dropped.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ColDrop</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">  char</span>
<span class="go">1    a</span>
<span class="go">2    b</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.ColRename">
<code class="sig-name descname">ColRename</code><span class="sig-paren">(</span><em class="sig-param">rename_map</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.ColRename" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that renames a column or columns to this pipeline stage.</p>
<dl class="simple">
<dt>rename_map<span class="classifier">dict</span></dt><dd><p>Maps old column names to new ones.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ColRename</span><span class="p">({</span><span class="s1">&#39;num&#39;</span><span class="p">:</span> <span class="s1">&#39;len&#39;</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   len initial</span>
<span class="go">1    8       a</span>
<span class="go">2    5       b</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.ColReorder">
<code class="sig-name descname">ColReorder</code><span class="sig-paren">(</span><em class="sig-param">positions</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.ColReorder" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that reorders columns to this pipeline stage.</p>
<dl class="simple">
<dt>positions<span class="classifier">dict</span></dt><dd><p>A mapping of column names to their desired positions after reordering.
Columns not included in the mapping will maintain their relative
positions over the non-mapped colums.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ColReorder</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   b  a  d  c</span>
<span class="go">0  4  8  7  3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.DropNa">
<code class="sig-name descname">DropNa</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.DropNa" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that drops null values to this pipeline stage.</p>
<p>Supports all parameter supported by pandas.dropna function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">DropNa</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a     b</span>
<span class="go">1  1   4.0</span>
<span class="go">3  1  11.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.DropRareTokens">
<code class="sig-name descname">DropRareTokens</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">threshold</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.DropRareTokens" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that drop rare tokens from token lists to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame for which to drop rare words.</p>
</dd>
<dt>threshold<span class="classifier">int</span></dt><dd><p>The rarity threshold to use. Only tokens appearing more than this
number of times in a column will remain in token lists in that column.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being transformed,
and the resulting columns retain the names of the source columns.
Otherwise, the new columns gain the suffix ‘_norare’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="s1">&#39;chars&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rare_dropper</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">DropRareTokens</span><span class="p">(</span><span class="s1">&#39;chars&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rare_dropper</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   num      chars</span>
<span class="go">0    7  [a, a, b]</span>
<span class="go">1    3        [b]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.Encode">
<code class="sig-name descname">Encode</code><span class="sig-paren">(</span><em class="sig-param">columns=None</em>, <em class="sig-param">exclude_columns=None</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.Encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that encodes categorical columns to integer values to this pipeline stage.</p>
<p>The encoder for each column is saved in the attribute ‘encoders’, which
is a dict mapping each encoded column name to the
sklearn.preprocessing.LabelEncoder object used to encode it.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Column names in the DataFrame to be encoded. If columns is None then
all the columns with object or category dtype will be encoded, except
those given in the exclude_columns parameter.</p>
</dd>
<dt>exclude_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Name or names of categorical columns to be excluded from encoding
when the columns parameter is not given. If None no column is excluded.
Ignored if the columns parameter is given.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being encoded,
and the resulting encoded columns retain the names of the source
columns. Otherwise, encoded columns gain the suffix ‘_enc’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;acd&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;lbl&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encode_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">Encode</span><span class="p">(</span><span class="s2">&quot;lbl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encode_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">     ph  lbl</span>
<span class="go">1   3.2    0</span>
<span class="go">2   7.2    1</span>
<span class="go">3  12.1    1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encode_stage</span><span class="o">.</span><span class="n">encoders</span><span class="p">[</span><span class="s2">&quot;lbl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">array([&#39;acd&#39;, &#39;alk&#39;, &#39;alk&#39;], dtype=object)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.FreqDrop">
<code class="sig-name descname">FreqDrop</code><span class="sig-paren">(</span><em class="sig-param">threshold</em>, <em class="sig-param">column</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.FreqDrop" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that drops rows by value frequency to this pipeline stage.</p>
<dl class="simple">
<dt>threshold<span class="classifier">int</span></dt><dd><p>The minimum frequency required for a value to be kept.</p>
</dd>
<dt>column<span class="classifier">str</span></dt><dd><p>The name of the colums to check for the given value frequency.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">FreqDrop</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a   b</span>
<span class="go">1  1   4</span>
<span class="go">3  1  11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.Log">
<code class="sig-name descname">Log</code><span class="sig-paren">(</span><em class="sig-param">columns=None</em>, <em class="sig-param">exclude=None</em>, <em class="sig-param">drop=False</em>, <em class="sig-param">non_neg=False</em>, <em class="sig-param">const_shift=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.Log" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that log-transforms numeric data to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Column names in the DataFrame to be encoded. If columns is None then
all the columns with a numeric dtype will be transformed, except those
given in the exclude_columns parameter.</p>
</dd>
<dt>exclude<span class="classifier">str or list-like, default None</span></dt><dd><p>Name or names of numeric columns to be excluded from log-transforming
when the columns parameter is not given. If None no column is excluded.
Ignored if the columns parameter is given.</p>
</dd>
<dt>drop<span class="classifier">bool, default False</span></dt><dd><p>If set to True, the source columns are dropped after being encoded,
and the resulting encoded columns retain the names of the source
columns. Otherwise, encoded columns gain the suffix ‘_log’.</p>
</dd>
<dt>non_neg<span class="classifier">bool, default False</span></dt><dd><p>If True, each transformed column is first shifted by smallest negative
value it includes (non-negative columns are thus not shifted).</p>
</dd>
<dt>const_shift<span class="classifier">int, optional</span></dt><dd><p>If given, each transformed column is first shifted by this constant. If
non_neg is True then that transformation is applied first, and only
then is the column shifted by this constant.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;acd&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;lbl&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">Log</span><span class="p">(</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">         ph  lbl</span>
<span class="go">1  1.163151  acd</span>
<span class="go">2  1.974081  alk</span>
<span class="go">3  2.493205  alk</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.MapColVals">
<code class="sig-name descname">MapColVals</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">value_map</em>, <em class="sig-param">result_columns=None</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">suffix=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.MapColVals" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that replaces the values of a column by a map to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">single label or list-like</span></dt><dd><p>Column labels in the DataFrame to be mapped.</p>
</dd>
<dt>value_map<span class="classifier">dict, function or pandas.Series</span></dt><dd><p>A dictionary mapping existing values to new ones. Values not in the
dictionary as keys will be converted to NaN. If a function is given, it
is applied element-wise to given columns. If a Series is given, values
are mapped by its index to its values.</p>
</dd>
<dt>result_columns<span class="classifier">single label or list-like, default None</span></dt><dd><p>Labels for the new columns resulting from the mapping operation. Must
be of the same length as columns. If None, behavior depends on the
drop parameter: If drop is True, then the label of the source column is
used; otherwise, the label of the source column is used with the suffix
‘_map’.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, source columns are dropped after being mapped.</p>
</dd>
<dt>suffix<span class="classifier">str, default ‘_map’</span></dt><dd><p>The suffix mapped columns gain if no new column labels are given.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;USSR&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Medal&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Gold&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Silver&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Bronze&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">MapColVals</span><span class="p">(</span><span class="s1">&#39;Medal&#39;</span><span class="p">,</span> <span class="n">value_map</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">       Medal</span>
<span class="go">UK      Gold</span>
<span class="go">USSR  Bronze</span>
<span class="go">US    Silver</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.OneHotEncode">
<code class="sig-name descname">OneHotEncode</code><span class="sig-paren">(</span><em class="sig-param">columns=None</em>, <em class="sig-param">dummy_na=False</em>, <em class="sig-param">exclude_columns=None</em>, <em class="sig-param">col_subset=False</em>, <em class="sig-param">drop_first=True</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.OneHotEncode" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that one-hot-encodes categorical columns to this pipeline stage.</p>
<p>By default only k-1 dummies are created fo k categorical levels, as to
avoid perfect multicollinearity between the dummy features (also called
the dummy variabletrap). This is done since features are usually one-hot
encoded for use with linear models, which require this behaviour.</p>
<dl class="simple">
<dt>columns<span class="classifier">single label or list-like, default None</span></dt><dd><p>Column labels in the DataFrame to be encoded. If columns is None then
all the columns with object or category dtype will be converted, except
those given in the exclude_columns parameter.</p>
</dd>
<dt>dummy_na<span class="classifier">bool, default False</span></dt><dd><p>Add a column to indicate NaNs, if False NaNs are ignored.</p>
</dd>
<dt>exclude_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Name or names of categorical columns to be excluded from encoding
when the columns parameter is not given. If None no column is excluded.
Ignored if the columns parameter is given.</p>
</dd>
<dt>col_subset<span class="classifier">bool, default False</span></dt><dd><p>If set to True, and only a subset of given columns is found, they are
encoded (if the missing columns are encoutered after the stage is
fitted they will be ignored). Otherwise, the stage will fail on the
precondition requiring all given columns are in input dataframes.</p>
</dd>
<dt>drop_first<span class="classifier">bool or single label, default True</span></dt><dd><p>Whether to get k-1 dummies out of k categorical levels by removing the
first level. If a non bool argument matching one of the categories is
provided, the dummy column corresponding to this value is dropped
instead of the first level; if it matches no category the first
category will still be dropped.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being encoded.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">&#39;USA&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;UK&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Greece&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Born&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">OneHotEncode</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   Born_UK  Born_USA</span>
<span class="go">1        0         1</span>
<span class="go">2        1         0</span>
<span class="go">3        0         0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.PdPipeline">
<code class="sig-name descname">PdPipeline</code><span class="sig-paren">(</span><em class="sig-param">stages</em>, <em class="sig-param">transformer_getter=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.PdPipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline for processing pandas DataFrame objects to this pipeline stage.</p>
<p>transformer_getter is usefull to avoid applying pipeline stages that are
aimed to filter out items in a big dataset to create a training set for a
machine learning model, for example, but should not be applied on future
individual items to be transformed by the fitted pipeline.</p>
<dl class="simple">
<dt>stages<span class="classifier">list</span></dt><dd><p>A list of PdPipelineStage objects making up this pipeline.</p>
</dd>
<dt>transform_getter<span class="classifier">callable, optional</span></dt><dd><p>A callable that can be applied to the fitted pipeline to produce a
sub-pipeline of it which should be used to transform dataframes after
the pipeline has been fitted. If not given, the fitted pipeline is used
entirely.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.RemoveStopwords">
<code class="sig-name descname">RemoveStopwords</code><span class="sig-paren">(</span><em class="sig-param">language</em>, <em class="sig-param">columns</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.RemoveStopwords" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that removes stopwords from a tokenized list to this pipeline stage.</p>
<dl class="simple">
<dt>langugae<span class="classifier">str or array-like</span></dt><dd><p>If a string is given, interpreted as the language of the stopwords, and
should then be one of the languages supported by the NLTK Stopwords
Corpus. If a list is given, it is assumed to be the list of stopwords
to remove.</p>
</dd>
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame from which to remove stopwords.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after stopword removal,
and the resulting columns retain the names of the source columns.
Otherwise, resulting columns gain the suffix ‘_nostop’.</p>
</dd>
</dl>
<p>&gt;&gt; import pandas as pd; import pdpipe as pdp;
&gt;&gt; data = [[3.2, [‘kick’, ‘the’, ‘baby’]]]
&gt;&gt; df = pd.DataFrame(data, [1], [‘freq’, ‘content’])
&gt;&gt; remove_stopwords = pdp.RemoveStopwords(‘english’, ‘content’)
&gt;&gt; remove_stopwords(df)</p>
<blockquote>
<div><p>freq       content</p>
</div></blockquote>
<p>1   3.2  [kick, baby]</p>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.RowDrop">
<code class="sig-name descname">RowDrop</code><span class="sig-paren">(</span><em class="sig-param">conditions</em>, <em class="sig-param">reduce=None</em>, <em class="sig-param">columns=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.RowDrop" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that drop rows by callable conditions to this pipeline stage.</p>
<dl class="simple">
<dt>conditions<span class="classifier">list-like or dict</span></dt><dd><p>The list of conditions that make a row eligible to be dropped. Each
condition must be a callable that take a cell value and return a bool
value. If a list of callables is given, the conditions are checked for
each column value of each row. If a dict mapping column labels to
callables is given, then each condition is only checked for the column
values of the designated column.</p>
</dd>
<dt>reduce<span class="classifier">‘any’, ‘all’ or ‘xor’, default ‘any’</span></dt><dd><p>Determines how row conditions are reduced. If set to ‘all’, a row must
satisfy all given conditions to be dropped. If set to ‘any’, rows
satisfying at least one of the conditions are dropped. If set to ‘xor’,
rows satisfying exactly one of the conditions will be dropped. Set to
‘any’ by default.</p>
</dd>
<dt>columns<span class="classifier">str or iterable, optional</span></dt><dd><p>The label, or an iterable of labels, of columns. Optional. If given,
input conditions will be applied to the sub-dataframe made up of
these columns to determine which rows to drop.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">RowDrop</span><span class="p">([</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a   b</span>
<span class="go">2  4   5</span>
<span class="go">3  5  11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">RowDrop</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">4</span><span class="p">})</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a   b</span>
<span class="go">1  1   4</span>
<span class="go">3  5  11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.Scale">
<code class="sig-name descname">Scale</code><span class="sig-paren">(</span><em class="sig-param">scaler</em>, <em class="sig-param">exclude_columns=None</em>, <em class="sig-param">exclude_object_columns=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.Scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that scales data to this pipeline stage.</p>
<dl class="simple">
<dt>scaler<span class="classifier">str</span></dt><dd><p>The type of scaler to use to scale the data. One of ‘StandardScaler’,
‘MinMaxScaler’, ‘MaxAbsScaler’, ‘RobustScaler’, ‘QuantileTransformer’
and ‘Normalizer’.</p>
</dd>
<dt>exclude_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Name or names of columns to be excluded from scaling. Excluded columns
are appended to the end of the resulting dataframe.</p>
</dd>
<dt>exclude_object_columns<span class="classifier">bool, default True</span></dt><dd><p>If set to True, all columns of dtype object are added to the list of
columns excluded from scaling.</p>
</dd>
<dt><a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs<span class="classifier">extra keyword arguments</span></dt><dd><p>All valid extra keyword arguments are forwarded to the scaler
constructor on scaler creation (e.g. ‘n_quantiles’ for
QuantileTransformer). PdPipelineStage valid keyword arguments are used
to override Scale class defaults.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;gt&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="s2">&quot;StandardScaler&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">         ph        gt</span>
<span class="go">1 -1.181449 -0.508001</span>
<span class="go">2 -0.082427  1.397001</span>
<span class="go">3  1.263876 -0.889001</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.SnowballStem">
<code class="sig-name descname">SnowballStem</code><span class="sig-paren">(</span><em class="sig-param">stemmer_name</em>, <em class="sig-param">columns</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.SnowballStem" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that stems words in a list using the Snowball stemmer to this pipeline stage.</p>
<dl class="simple">
<dt>stemmer_name<span class="classifier">str</span></dt><dd><p>The name of the Snowball stemmer to use. Should be one of the Snowball
stemmers implemented by nltk. E.g. ‘EnglishStemmer’.</p>
</dd>
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame to stem tokens in.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after stemming, and the
resulting columns retain the names of the source columns. Otherwise,
resulting columns gain the suffix ‘_stem’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;kicking&#39;</span><span class="p">,</span> <span class="s1">&#39;boats&#39;</span><span class="p">]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">remove_stopwords</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">SnowballStem</span><span class="p">(</span><span class="s1">&#39;EnglishStemmer&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">remove_stopwords</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   freq       content</span>
<span class="go">1   3.2  [kick, boat]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.TokenizeWords">
<code class="sig-name descname">TokenizeWords</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.TokenizeWords" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that tokenize a sentence into words by whitespaces to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame to be tokenized.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being tokenized,
and the resulting tokenized columns retain the names of the source
columns. Otherwise, tokenized columns gain the suffix ‘_tok’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;Kick the baby!&quot;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokenize_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">TokenizeWords</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokenize_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   freq               content</span>
<span class="go">1   3.2  [Kick, the, baby, !]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.UntokenizeWords">
<code class="sig-name descname">UntokenizeWords</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.UntokenizeWords" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that joins token lists to whitespace-seperated strings to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame to be untokenized.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being untokenized,
and the resulting columns retain the names of the source columns.
Otherwise, untokenized columns gain the suffix ‘_untok’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Shake&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="s1">&#39;bake!&#39;</span><span class="p">]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">untokenize_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">UntokenizeWords</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">untokenize_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   freq          content</span>
<span class="go">1   3.2  Shake and bake!</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.ValDrop">
<code class="sig-name descname">ValDrop</code><span class="sig-paren">(</span><em class="sig-param">values</em>, <em class="sig-param">columns=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.ValDrop" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that drops rows by value to this pipeline stage.</p>
<dl class="simple">
<dt>values<span class="classifier">list-like</span></dt><dd><p>A list of the values to drop.</p>
</dd>
<dt>columns<span class="classifier">str or list-like, default None</span></dt><dd><p>The name, or an iterable of names, of columns to check for the given
values. If set to None, all columns are checked.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">18</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ValDrop</span><span class="p">([</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">    a   b</span>
<span class="go">1   1   4</span>
<span class="go">3  18  11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ValDrop</span><span class="p">([</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">    a   b</span>
<span class="go">3  18  11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.ValKeep">
<code class="sig-name descname">ValKeep</code><span class="sig-paren">(</span><em class="sig-param">values</em>, <em class="sig-param">columns=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.ValKeep" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds a pipeline stage that keeps rows by value to this pipeline stage.</p>
<dl class="simple">
<dt>values<span class="classifier">list-like</span></dt><dd><p>A list of the values to keep.</p>
</dd>
<dt>columns<span class="classifier">str or list-like, default None</span></dt><dd><p>The name, or an iterable of names, of columns to check for the given
values. If set to None, all columns are checked.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ValKeep</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a   b</span>
<span class="go">2  4   5</span>
<span class="go">3  5  11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ValKeep</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a  b</span>
<span class="go">2  4  5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">exraise=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pdpipe.core.PdPipelineStage.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies this pipeline stage to the given dataframe.</p>
<p>If the stage is not fitted fit_transform is called. Otherwise,
transform is called.</p>
<dl class="simple">
<dt>df<span class="classifier">pandas.DataFrame</span></dt><dd><p>The dataframe to which this pipeline stage will be applied.</p>
</dd>
<dt>exraise<span class="classifier">bool, default None</span></dt><dd><p>Determines behaviour if the precondition of this stage is not
fulfilled by the given dataframe: If True,
a pdpipe.FailedPreconditionError is raised. If False, the stage is
skipped. If None, the default behaviour of this stage is used, as
determined by the exraise constructor parameter.</p>
</dd>
<dt>verbose<span class="classifier">bool, default False</span></dt><dd><p>If True an explanation message is printed after the precondition
is checked but before the application of the pipeline stage.
Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>The resulting dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">exraise=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pdpipe.core.PdPipelineStage.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies this pipeline stage to the given dataframe.</p>
<p>If the stage is not fitted fit_transform is called. Otherwise,
transform is called.</p>
<dl class="simple">
<dt>df<span class="classifier">pandas.DataFrame</span></dt><dd><p>The dataframe to which this pipeline stage will be applied.</p>
</dd>
<dt>exraise<span class="classifier">bool, default None</span></dt><dd><p>Determines behaviour if the precondition of this stage is not
fulfilled by the given dataframe: If True,
a pdpipe.FailedPreconditionError is raised. If False, the stage is
skipped. If None, the default behaviour of this stage is used, as
determined by the exraise constructor parameter.</p>
</dd>
<dt>verbose<span class="classifier">bool, default False</span></dt><dd><p>If True an explanation message is printed after the precondition
is checked but before the application of the pipeline stage.
Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>The resulting dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.description">
<code class="sig-name descname">description</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.description"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pdpipe.core.PdPipelineStage.description" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the description of this pipeline stage</p>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">y=None</em>, <em class="sig-param">exraise=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pdpipe.core.PdPipelineStage.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits this stage without transforming the given dataframe.</p>
<dl class="simple">
<dt>X<span class="classifier">pandas.DataFrame</span></dt><dd><p>The dataframe to be transformed.</p>
</dd>
<dt>y<span class="classifier">array-like, optional</span></dt><dd><p>Targets for supervised learning.</p>
</dd>
<dt>exraise<span class="classifier">bool, default None</span></dt><dd><p>Determines behaviour if the precondition of this stage is not
fulfilled by the given dataframe: If True,
a pdpipe.FailedPreconditionError is raised. If False, the stage is
skipped. If None, the default behaviour of this stage is used, as
determined by the exraise constructor parameter.</p>
</dd>
<dt>verbose<span class="classifier">bool, default False</span></dt><dd><p>If True an explanation message is printed after the precondition
is checked but before the application of the pipeline stage.
Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>The resulting dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">y=None</em>, <em class="sig-param">exraise=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pdpipe.core.PdPipelineStage.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits this stage and transforms the given dataframe.</p>
<dl class="simple">
<dt>X<span class="classifier">pandas.DataFrame</span></dt><dd><p>The dataframe to transform and fit this pipeline stage by.</p>
</dd>
<dt>y<span class="classifier">array-like, optional</span></dt><dd><p>Targets for supervised learning.</p>
</dd>
<dt>exraise<span class="classifier">bool, default None</span></dt><dd><p>Determines behaviour if the precondition of this stage is not
fulfilled by the given dataframe: If True,
a pdpipe.FailedPreconditionError is raised. If False, the stage is
skipped. If None, the default behaviour of this stage is used, as
determined by the exraise constructor parameter.</p>
</dd>
<dt>verbose<span class="classifier">bool, default False</span></dt><dd><p>If True an explanation message is printed after the precondition
is checked but before the application of the pipeline stage.
Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>The resulting dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pdpipe.core.PdPipelineStage.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">y=None</em>, <em class="sig-param">exraise=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pdpipe.core.PdPipelineStage.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the given dataframe without fitting this stage.</p>
<p>If this stage is fittable but is not fitter, an
UnfittedPipelineStageError is raised.</p>
<dl class="simple">
<dt>X<span class="classifier">pandas.DataFrame</span></dt><dd><p>The dataframe to be transformed.</p>
</dd>
<dt>y<span class="classifier">array-like, optional</span></dt><dd><p>Targets for supervised learning.</p>
</dd>
<dt>exraise<span class="classifier">bool, default None</span></dt><dd><p>Determines behaviour if the precondition of this stage is not
fulfilled by the given dataframe: If True,
a pdpipe.FailedPreconditionError is raised. If False, the stage is
skipped. If None, the default behaviour of this stage is used, as
determined by the exraise constructor parameter.</p>
</dd>
<dt>verbose<span class="classifier">bool, default False</span></dt><dd><p>If True an explanation message is printed after the precondition
is checked but before the application of the pipeline stage.
Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>The resulting dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">exraise=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.apply"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Applies this pipeline stage to the given dataframe.</p>
<p>If the stage is not fitted fit_transform is called. Otherwise,
transform is called.</p>
<dl class="simple">
<dt>df<span class="classifier">pandas.DataFrame</span></dt><dd><p>The dataframe to which this pipeline stage will be applied.</p>
</dd>
<dt>exraise<span class="classifier">bool, default None</span></dt><dd><p>Determines behaviour if the precondition of this stage is not
fulfilled by the given dataframe: If True,
a pdpipe.FailedPreconditionError is raised. If False, the stage is
skipped. If None, the default behaviour of this stage is used, as
determined by the exraise constructor parameter.</p>
</dd>
<dt>verbose<span class="classifier">bool, default False</span></dt><dd><p>If True an explanation message is printed after the precondition
is checked but before the application of the pipeline stage.
Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>The resulting dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">y=None</em>, <em class="sig-param">exraise=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.fit_transform"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Fits this stage and transforms the given dataframe.</p>
<dl class="simple">
<dt>X<span class="classifier">pandas.DataFrame</span></dt><dd><p>The dataframe to transform and fit this pipeline stage by.</p>
</dd>
<dt>y<span class="classifier">array-like, optional</span></dt><dd><p>Targets for supervised learning.</p>
</dd>
<dt>exraise<span class="classifier">bool, default None</span></dt><dd><p>Determines behaviour if the precondition of this stage is not
fulfilled by the given dataframe: If True,
a pdpipe.FailedPreconditionError is raised. If False, the stage is
skipped. If None, the default behaviour of this stage is used, as
determined by the exraise constructor parameter.</p>
</dd>
<dt>verbose<span class="classifier">bool, default False</span></dt><dd><p>If True an explanation message is printed after the precondition
is checked but before the application of the pipeline stage.
Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>The resulting dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">y=None</em>, <em class="sig-param">exraise=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.fit"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Fits this stage without transforming the given dataframe.</p>
<dl class="simple">
<dt>X<span class="classifier">pandas.DataFrame</span></dt><dd><p>The dataframe to be transformed.</p>
</dd>
<dt>y<span class="classifier">array-like, optional</span></dt><dd><p>Targets for supervised learning.</p>
</dd>
<dt>exraise<span class="classifier">bool, default None</span></dt><dd><p>Determines behaviour if the precondition of this stage is not
fulfilled by the given dataframe: If True,
a pdpipe.FailedPreconditionError is raised. If False, the stage is
skipped. If None, the default behaviour of this stage is used, as
determined by the exraise constructor parameter.</p>
</dd>
<dt>verbose<span class="classifier">bool, default False</span></dt><dd><p>If True an explanation message is printed after the precondition
is checked but before the application of the pipeline stage.
Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>The resulting dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">y=None</em>, <em class="sig-param">exraise=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.transform"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Transforms the given dataframe without fitting this stage.</p>
<p>If this stage is fittable but is not fitter, an
UnfittedPipelineStageError is raised.</p>
<dl class="simple">
<dt>X<span class="classifier">pandas.DataFrame</span></dt><dd><p>The dataframe to be transformed.</p>
</dd>
<dt>y<span class="classifier">array-like, optional</span></dt><dd><p>Targets for supervised learning.</p>
</dd>
<dt>exraise<span class="classifier">bool, default None</span></dt><dd><p>Determines behaviour if the precondition of this stage is not
fulfilled by the given dataframe: If True,
a pdpipe.FailedPreconditionError is raised. If False, the stage is
skipped. If None, the default behaviour of this stage is used, as
determined by the exraise constructor parameter.</p>
</dd>
<dt>verbose<span class="classifier">bool, default False</span></dt><dd><p>If True an explanation message is printed after the precondition
is checked but before the application of the pipeline stage.
Defaults to False.</p>
</dd>
</dl>
<dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>The resulting dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">description</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pdpipe/core.html#PdPipelineStage.description"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the description of this pipeline stage</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">AdHocStage</code><span class="sig-paren">(</span><em class="sig-param">transform</em>, <em class="sig-param">prec=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds an ad-hoc stage of a pandas DataFrame-processing pipeline to this pipeline stage.</p>
<dl class="simple">
<dt>transform<span class="classifier">callable</span></dt><dd><p>The transformation this stage applies to dataframes.</p>
</dd>
<dt>prec<span class="classifier">callable, default None</span></dt><dd><p>A callable that returns a boolean value. Represent a a precondition
used to determine whether this stage can be applied to a given
dataframe. If None is given, set to a function always returning True.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">AggByCols</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">func</em>, <em class="sig-param">result_columns=None</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">func_desc=None</em>, <em class="sig-param">suffix=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage applying a series-wise function to columns to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Names of columns on which to apply the given function.</p>
</dd>
<dt>func<span class="classifier">function</span></dt><dd><p>The function to be applied to each element of the given columns.</p>
</dd>
<dt>result_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>The names of the new columns resulting from the mapping operation. Must
be of the same length as columns. If None, behavior depends on the
drop parameter: If drop is True, the name of the source column is used;
otherwise, the name of the source column is used with a defined suffix.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, source columns are dropped after being mapped.</p>
</dd>
<dt>func_desc<span class="classifier">str, default None</span></dt><dd><p>A function description of the given function; e.g. ‘normalizing revenue
by company size’. A default description is used if None is given.</p>
</dd>
<dt>suffix<span class="classifier">str, optional</span></dt><dd><p>The suffix to add to resulting columns in case where results_columns
is None and drop is set to False. Of not given, defaults to ‘_agg’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;acd&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;lbl&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_ph</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ApplyByCols</span><span class="p">(</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_ph</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">         ph  lbl</span>
<span class="go">1  1.163151  acd</span>
<span class="go">2  1.974081  alk</span>
<span class="go">3  2.493205  alk</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">ApplyByCols</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">func</em>, <em class="sig-param">result_columns=None</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">func_desc=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage applying an element-wise function to columns to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Names of columns on which to apply the given function.</p>
</dd>
<dt>func<span class="classifier">function</span></dt><dd><p>The function to be applied to each element of the given columns.</p>
</dd>
<dt>result_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>The names of the new columns resulting from the mapping operation. Must
be of the same length as columns. If None, behavior depends on the
drop parameter: If drop is True, the name of the source column is used;
otherwise, the name of the source column is used with the suffix
‘_app’.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, source columns are dropped after being mapped.</p>
</dd>
<dt>func_desc<span class="classifier">str, default None</span></dt><dd><p>A function description of the given function; e.g. ‘normalizing revenue
by company size’. A default description is used if None is given.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">math</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;acd&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;lbl&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_ph</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ApplyByCols</span><span class="p">(</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">round_ph</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   ph  lbl</span>
<span class="go">1   4  acd</span>
<span class="go">2   8  alk</span>
<span class="go">3  13  alk</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">ApplyToRows</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">colname=None</em>, <em class="sig-param">follow_column=None</em>, <em class="sig-param">func_desc=None</em>, <em class="sig-param">prec=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage generating columns by applying a function to each row to this pipeline stage.</p>
<dl class="simple">
<dt>func<span class="classifier">function</span></dt><dd><p>The function to be applied to each row of the processed DataFrame.</p>
</dd>
<dt>colname<span class="classifier">single label, default None</span></dt><dd><p>The label of the new column resulting from the function application. If
None, ‘new_col’ is used. Ignored if a DataFrame is generated by the
function (i.e. each row generates a Series rather than a value), in
which case the laebl of each column in the resulting DataFrame is used.</p>
</dd>
<dt>follow_column<span class="classifier">str, default None</span></dt><dd><p>Resulting columns will be inserted after this column. If None, new
columns are inserted at the end of the processed DataFrame.</p>
</dd>
<dt>func_desc<span class="classifier">str, default None</span></dt><dd><p>A function description of the given function; e.g. ‘normalizing revenue
by company size’. A default description is used if None is given.</p>
</dd>
<dt>prec<span class="classifier">function, default None</span></dt><dd><p>A function taking a DataFrame, returning True if it this stage is
applicable to the given DataFrame. If None is given, a function always
returning True is used.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2143</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1321</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1255</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;years&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_revenue&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_rev</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;years&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;avg_revenue&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_total_rev</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ApplyToRows</span><span class="p">(</span><span class="n">total_rev</span><span class="p">,</span> <span class="s1">&#39;total_revenue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_total_rev</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   years  avg_revenue  total_revenue</span>
<span class="go">1      3         2143           6429</span>
<span class="go">2     10         1321          13210</span>
<span class="go">3      7         1255           8785</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">halfer</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">new</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year/2&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;years&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rev/2&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;avg_revenue&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">}</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_cols</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ApplyToRows</span><span class="p">(</span><span class="n">halfer</span><span class="p">,</span> <span class="n">follow_column</span><span class="o">=</span><span class="s1">&#39;years&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_cols</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   years   rev/2  year/2  avg_revenue</span>
<span class="go">1      3  1071.5     1.5         2143</span>
<span class="go">2     10   660.5     5.0         1321</span>
<span class="go">3      7   627.5     3.5         1255</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">Bin</code><span class="sig-paren">(</span><em class="sig-param">bin_map</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that adds a binned version of a column or columns to this pipeline stage.</p>
<p>If drop is set to True the new columns retain the names of the source
columns; otherwise, the resulting column gain the suffix ‘_bin’</p>
<dl class="simple">
<dt>bin_map<span class="classifier">dict</span></dt><dd><p>Maps column labels to bin arrays. The bin array is interpreted as
containing start points of consecutive bins, except for the final
point, assumed to be the end point of the last bin. Additionally, a
bin array implicitly projects a left-most bin containing all elements
smaller than the left-most end point and a right-most bin containing
all elements larger that the right-most end point. For example, the
list [0, 5, 8] is interpreted as the bins (-∞, 0),
[0-5), [5-8) and [8, ∞).</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being binned.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;speed&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">Bin</span><span class="p">({</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]},</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   speed speed_bin</span>
<span class="go">1     -3        &lt;5</span>
<span class="go">2      4        &lt;5</span>
<span class="go">3      5        5≤</span>
<span class="go">4      9        5≤</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">Bin</span><span class="p">({</span><span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">]},</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   speed speed_bin</span>
<span class="go">1     -3        &lt;0</span>
<span class="go">2      4       0-5</span>
<span class="go">3      5       5-8</span>
<span class="go">4      9        8≤</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">ColByFrameFunc</code><span class="sig-paren">(</span><em class="sig-param">column</em>, <em class="sig-param">func</em>, <em class="sig-param">follow_column=None</em>, <em class="sig-param">func_desc=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage adding a column by applying a dataframw-wide function to this pipeline stage.</p>
<dl class="simple">
<dt>column<span class="classifier">str</span></dt><dd><p>The name of the resulting column.</p>
</dd>
<dt>func<span class="classifier">function</span></dt><dd><p>The function to be applied to the input dataframe. The function should
return a pandas.Series object.</p>
</dd>
<dt>follow_column<span class="classifier">str, default None</span></dt><dd><p>Resulting columns will be inserted after this column. If None, new
columns are inserted at the end of the processed DataFrame.</p>
</dd>
<dt>func_desc<span class="classifier">str, default None</span></dt><dd><p>A function description of the given function; e.g. ‘normalizing revenue
by company size’. A default description is used if None is given.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_equal</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">ColByFrameFunc</span><span class="p">(</span><span class="s2">&quot;A==B&quot;</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_equal</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   A  B   A==B</span>
<span class="go">1  3  3   True</span>
<span class="go">2  2  4  False</span>
<span class="go">3  1  5  False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">ColDrop</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">errors=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that drops columns by name to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str, iterable or callable</span></dt><dd><p>The label, or an iterable of labels, of columns to drop. Alternatively,
columns can be assigned a callable returning bool values for
pandas.Series objects; if this is the case, every column for which it
return True will be dropped.</p>
</dd>
<dt>errors<span class="classifier">{‘ignore’, ‘raise’}, default ‘raise’</span></dt><dd><p>If ‘ignore’, suppress error and existing labels are dropped.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ColDrop</span><span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">  char</span>
<span class="go">1    a</span>
<span class="go">2    b</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">ColRename</code><span class="sig-paren">(</span><em class="sig-param">rename_map</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that renames a column or columns to this pipeline stage.</p>
<dl class="simple">
<dt>rename_map<span class="classifier">dict</span></dt><dd><p>Maps old column names to new ones.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ColRename</span><span class="p">({</span><span class="s1">&#39;num&#39;</span><span class="p">:</span> <span class="s1">&#39;len&#39;</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   len initial</span>
<span class="go">1    8       a</span>
<span class="go">2    5       b</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">ColReorder</code><span class="sig-paren">(</span><em class="sig-param">positions</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that reorders columns to this pipeline stage.</p>
<dl class="simple">
<dt>positions<span class="classifier">dict</span></dt><dd><p>A mapping of column names to their desired positions after reordering.
Columns not included in the mapping will maintain their relative
positions over the non-mapped colums.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ColReorder</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   b  a  d  c</span>
<span class="go">0  4  8  7  3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">DropNa</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that drops null values to this pipeline stage.</p>
<p>Supports all parameter supported by pandas.dropna function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">DropNa</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a     b</span>
<span class="go">1  1   4.0</span>
<span class="go">3  1  11.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">DropRareTokens</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">threshold</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that drop rare tokens from token lists to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame for which to drop rare words.</p>
</dd>
<dt>threshold<span class="classifier">int</span></dt><dd><p>The rarity threshold to use. Only tokens appearing more than this
number of times in a column will remain in token lists in that column.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being transformed,
and the resulting columns retain the names of the source columns.
Otherwise, the new columns gain the suffix ‘_norare’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="s1">&#39;chars&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rare_dropper</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">DropRareTokens</span><span class="p">(</span><span class="s1">&#39;chars&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rare_dropper</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   num      chars</span>
<span class="go">0    7  [a, a, b]</span>
<span class="go">1    3        [b]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">Encode</code><span class="sig-paren">(</span><em class="sig-param">columns=None</em>, <em class="sig-param">exclude_columns=None</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that encodes categorical columns to integer values to this pipeline stage.</p>
<p>The encoder for each column is saved in the attribute ‘encoders’, which
is a dict mapping each encoded column name to the
sklearn.preprocessing.LabelEncoder object used to encode it.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Column names in the DataFrame to be encoded. If columns is None then
all the columns with object or category dtype will be encoded, except
those given in the exclude_columns parameter.</p>
</dd>
<dt>exclude_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Name or names of categorical columns to be excluded from encoding
when the columns parameter is not given. If None no column is excluded.
Ignored if the columns parameter is given.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being encoded,
and the resulting encoded columns retain the names of the source
columns. Otherwise, encoded columns gain the suffix ‘_enc’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;acd&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;lbl&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encode_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">Encode</span><span class="p">(</span><span class="s2">&quot;lbl&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encode_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">     ph  lbl</span>
<span class="go">1   3.2    0</span>
<span class="go">2   7.2    1</span>
<span class="go">3  12.1    1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encode_stage</span><span class="o">.</span><span class="n">encoders</span><span class="p">[</span><span class="s2">&quot;lbl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">array([&#39;acd&#39;, &#39;alk&#39;, &#39;alk&#39;], dtype=object)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">FreqDrop</code><span class="sig-paren">(</span><em class="sig-param">threshold</em>, <em class="sig-param">column</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that drops rows by value frequency to this pipeline stage.</p>
<dl class="simple">
<dt>threshold<span class="classifier">int</span></dt><dd><p>The minimum frequency required for a value to be kept.</p>
</dd>
<dt>column<span class="classifier">str</span></dt><dd><p>The name of the colums to check for the given value frequency.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">FreqDrop</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a   b</span>
<span class="go">1  1   4</span>
<span class="go">3  1  11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">Log</code><span class="sig-paren">(</span><em class="sig-param">columns=None</em>, <em class="sig-param">exclude=None</em>, <em class="sig-param">drop=False</em>, <em class="sig-param">non_neg=False</em>, <em class="sig-param">const_shift=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that log-transforms numeric data to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Column names in the DataFrame to be encoded. If columns is None then
all the columns with a numeric dtype will be transformed, except those
given in the exclude_columns parameter.</p>
</dd>
<dt>exclude<span class="classifier">str or list-like, default None</span></dt><dd><p>Name or names of numeric columns to be excluded from log-transforming
when the columns parameter is not given. If None no column is excluded.
Ignored if the columns parameter is given.</p>
</dd>
<dt>drop<span class="classifier">bool, default False</span></dt><dd><p>If set to True, the source columns are dropped after being encoded,
and the resulting encoded columns retain the names of the source
columns. Otherwise, encoded columns gain the suffix ‘_log’.</p>
</dd>
<dt>non_neg<span class="classifier">bool, default False</span></dt><dd><p>If True, each transformed column is first shifted by smallest negative
value it includes (non-negative columns are thus not shifted).</p>
</dd>
<dt>const_shift<span class="classifier">int, optional</span></dt><dd><p>If given, each transformed column is first shifted by this constant. If
non_neg is True then that transformation is applied first, and only
then is the column shifted by this constant.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;acd&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="s2">&quot;alk&quot;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;lbl&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">Log</span><span class="p">(</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">         ph  lbl</span>
<span class="go">1  1.163151  acd</span>
<span class="go">2  1.974081  alk</span>
<span class="go">3  2.493205  alk</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">MapColVals</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">value_map</em>, <em class="sig-param">result_columns=None</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">suffix=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that replaces the values of a column by a map to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">single label or list-like</span></dt><dd><p>Column labels in the DataFrame to be mapped.</p>
</dd>
<dt>value_map<span class="classifier">dict, function or pandas.Series</span></dt><dd><p>A dictionary mapping existing values to new ones. Values not in the
dictionary as keys will be converted to NaN. If a function is given, it
is applied element-wise to given columns. If a Series is given, values
are mapped by its index to its values.</p>
</dd>
<dt>result_columns<span class="classifier">single label or list-like, default None</span></dt><dd><p>Labels for the new columns resulting from the mapping operation. Must
be of the same length as columns. If None, behavior depends on the
drop parameter: If drop is True, then the label of the source column is
used; otherwise, the label of the source column is used with the suffix
‘_map’.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, source columns are dropped after being mapped.</p>
</dd>
<dt>suffix<span class="classifier">str, default ‘_map’</span></dt><dd><p>The suffix mapped columns gain if no new column labels are given.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;USSR&#39;</span><span class="p">,</span> <span class="s1">&#39;US&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Medal&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Gold&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Silver&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Bronze&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">MapColVals</span><span class="p">(</span><span class="s1">&#39;Medal&#39;</span><span class="p">,</span> <span class="n">value_map</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">       Medal</span>
<span class="go">UK      Gold</span>
<span class="go">USSR  Bronze</span>
<span class="go">US    Silver</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">OneHotEncode</code><span class="sig-paren">(</span><em class="sig-param">columns=None</em>, <em class="sig-param">dummy_na=False</em>, <em class="sig-param">exclude_columns=None</em>, <em class="sig-param">col_subset=False</em>, <em class="sig-param">drop_first=True</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that one-hot-encodes categorical columns to this pipeline stage.</p>
<p>By default only k-1 dummies are created fo k categorical levels, as to
avoid perfect multicollinearity between the dummy features (also called
the dummy variabletrap). This is done since features are usually one-hot
encoded for use with linear models, which require this behaviour.</p>
<dl class="simple">
<dt>columns<span class="classifier">single label or list-like, default None</span></dt><dd><p>Column labels in the DataFrame to be encoded. If columns is None then
all the columns with object or category dtype will be converted, except
those given in the exclude_columns parameter.</p>
</dd>
<dt>dummy_na<span class="classifier">bool, default False</span></dt><dd><p>Add a column to indicate NaNs, if False NaNs are ignored.</p>
</dd>
<dt>exclude_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Name or names of categorical columns to be excluded from encoding
when the columns parameter is not given. If None no column is excluded.
Ignored if the columns parameter is given.</p>
</dd>
<dt>col_subset<span class="classifier">bool, default False</span></dt><dd><p>If set to True, and only a subset of given columns is found, they are
encoded (if the missing columns are encoutered after the stage is
fitted they will be ignored). Otherwise, the stage will fail on the
precondition requiring all given columns are in input dataframes.</p>
</dd>
<dt>drop_first<span class="classifier">bool or single label, default True</span></dt><dd><p>Whether to get k-1 dummies out of k categorical levels by removing the
first level. If a non bool argument matching one of the categories is
provided, the dummy column corresponding to this value is dropped
instead of the first level; if it matches no category the first
category will still be dropped.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being encoded.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">&#39;USA&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;UK&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Greece&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Born&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">OneHotEncode</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   Born_UK  Born_USA</span>
<span class="go">1        0         1</span>
<span class="go">2        1         0</span>
<span class="go">3        0         0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">PdPipeline</code><span class="sig-paren">(</span><em class="sig-param">stages</em>, <em class="sig-param">transformer_getter=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline for processing pandas DataFrame objects to this pipeline stage.</p>
<p>transformer_getter is usefull to avoid applying pipeline stages that are
aimed to filter out items in a big dataset to create a training set for a
machine learning model, for example, but should not be applied on future
individual items to be transformed by the fitted pipeline.</p>
<dl class="simple">
<dt>stages<span class="classifier">list</span></dt><dd><p>A list of PdPipelineStage objects making up this pipeline.</p>
</dd>
<dt>transform_getter<span class="classifier">callable, optional</span></dt><dd><p>A callable that can be applied to the fitted pipeline to produce a
sub-pipeline of it which should be used to transform dataframes after
the pipeline has been fitted. If not given, the fitted pipeline is used
entirely.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">RemoveStopwords</code><span class="sig-paren">(</span><em class="sig-param">language</em>, <em class="sig-param">columns</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that removes stopwords from a tokenized list to this pipeline stage.</p>
<dl class="simple">
<dt>langugae<span class="classifier">str or array-like</span></dt><dd><p>If a string is given, interpreted as the language of the stopwords, and
should then be one of the languages supported by the NLTK Stopwords
Corpus. If a list is given, it is assumed to be the list of stopwords
to remove.</p>
</dd>
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame from which to remove stopwords.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after stopword removal,
and the resulting columns retain the names of the source columns.
Otherwise, resulting columns gain the suffix ‘_nostop’.</p>
</dd>
</dl>
<p>&gt;&gt; import pandas as pd; import pdpipe as pdp;
&gt;&gt; data = [[3.2, [‘kick’, ‘the’, ‘baby’]]]
&gt;&gt; df = pd.DataFrame(data, [1], [‘freq’, ‘content’])
&gt;&gt; remove_stopwords = pdp.RemoveStopwords(‘english’, ‘content’)
&gt;&gt; remove_stopwords(df)</p>
<blockquote>
<div><p>freq       content</p>
</div></blockquote>
<p>1   3.2  [kick, baby]</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">RowDrop</code><span class="sig-paren">(</span><em class="sig-param">conditions</em>, <em class="sig-param">reduce=None</em>, <em class="sig-param">columns=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that drop rows by callable conditions to this pipeline stage.</p>
<dl class="simple">
<dt>conditions<span class="classifier">list-like or dict</span></dt><dd><p>The list of conditions that make a row eligible to be dropped. Each
condition must be a callable that take a cell value and return a bool
value. If a list of callables is given, the conditions are checked for
each column value of each row. If a dict mapping column labels to
callables is given, then each condition is only checked for the column
values of the designated column.</p>
</dd>
<dt>reduce<span class="classifier">‘any’, ‘all’ or ‘xor’, default ‘any’</span></dt><dd><p>Determines how row conditions are reduced. If set to ‘all’, a row must
satisfy all given conditions to be dropped. If set to ‘any’, rows
satisfying at least one of the conditions are dropped. If set to ‘xor’,
rows satisfying exactly one of the conditions will be dropped. Set to
‘any’ by default.</p>
</dd>
<dt>columns<span class="classifier">str or iterable, optional</span></dt><dd><p>The label, or an iterable of labels, of columns. Optional. If given,
input conditions will be applied to the sub-dataframe made up of
these columns to determine which rows to drop.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">RowDrop</span><span class="p">([</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a   b</span>
<span class="go">2  4   5</span>
<span class="go">3  5  11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">RowDrop</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">4</span><span class="p">})</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a   b</span>
<span class="go">1  1   4</span>
<span class="go">3  5  11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">Scale</code><span class="sig-paren">(</span><em class="sig-param">scaler</em>, <em class="sig-param">exclude_columns=None</em>, <em class="sig-param">exclude_object_columns=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that scales data to this pipeline stage.</p>
<dl class="simple">
<dt>scaler<span class="classifier">str</span></dt><dd><p>The type of scaler to use to scale the data. One of ‘StandardScaler’,
‘MinMaxScaler’, ‘MaxAbsScaler’, ‘RobustScaler’, ‘QuantileTransformer’
and ‘Normalizer’.</p>
</dd>
<dt>exclude_columns<span class="classifier">str or list-like, default None</span></dt><dd><p>Name or names of columns to be excluded from scaling. Excluded columns
are appended to the end of the resulting dataframe.</p>
</dd>
<dt>exclude_object_columns<span class="classifier">bool, default True</span></dt><dd><p>If set to True, all columns of dtype object are added to the list of
columns excluded from scaling.</p>
</dd>
<dt><a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs<span class="classifier">extra keyword arguments</span></dt><dd><p>All valid extra keyword arguments are forwarded to the scaler
constructor on scaler creation (e.g. ‘n_quantiles’ for
QuantileTransformer). PdPipelineStage valid keyword arguments are used
to override Scale class defaults.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.2</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ph&quot;</span><span class="p">,</span><span class="s2">&quot;gt&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="s2">&quot;StandardScaler&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">         ph        gt</span>
<span class="go">1 -1.181449 -0.508001</span>
<span class="go">2 -0.082427  1.397001</span>
<span class="go">3  1.263876 -0.889001</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">SnowballStem</code><span class="sig-paren">(</span><em class="sig-param">stemmer_name</em>, <em class="sig-param">columns</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that stems words in a list using the Snowball stemmer to this pipeline stage.</p>
<dl class="simple">
<dt>stemmer_name<span class="classifier">str</span></dt><dd><p>The name of the Snowball stemmer to use. Should be one of the Snowball
stemmers implemented by nltk. E.g. ‘EnglishStemmer’.</p>
</dd>
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame to stem tokens in.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after stemming, and the
resulting columns retain the names of the source columns. Otherwise,
resulting columns gain the suffix ‘_stem’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;kicking&#39;</span><span class="p">,</span> <span class="s1">&#39;boats&#39;</span><span class="p">]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">remove_stopwords</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">SnowballStem</span><span class="p">(</span><span class="s1">&#39;EnglishStemmer&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">remove_stopwords</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   freq       content</span>
<span class="go">1   3.2  [kick, boat]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">TokenizeWords</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that tokenize a sentence into words by whitespaces to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame to be tokenized.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being tokenized,
and the resulting tokenized columns retain the names of the source
columns. Otherwise, tokenized columns gain the suffix ‘_tok’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;Kick the baby!&quot;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokenize_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">TokenizeWords</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tokenize_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   freq               content</span>
<span class="go">1   3.2  [Kick, the, baby, !]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">UntokenizeWords</code><span class="sig-paren">(</span><em class="sig-param">columns</em>, <em class="sig-param">drop=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that joins token lists to whitespace-seperated strings to this pipeline stage.</p>
<dl class="simple">
<dt>columns<span class="classifier">str or list-like</span></dt><dd><p>Column names in the DataFrame to be untokenized.</p>
</dd>
<dt>drop<span class="classifier">bool, default True</span></dt><dd><p>If set to True, the source columns are dropped after being untokenized,
and the resulting columns retain the names of the source columns.
Otherwise, untokenized columns gain the suffix ‘_untok’.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">3.2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Shake&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="s1">&#39;bake!&#39;</span><span class="p">]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">untokenize_stage</span> <span class="o">=</span> <span class="n">pdp</span><span class="o">.</span><span class="n">UntokenizeWords</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">untokenize_stage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   freq          content</span>
<span class="go">1   3.2  Shake and bake!</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">ValDrop</code><span class="sig-paren">(</span><em class="sig-param">values</em>, <em class="sig-param">columns=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that drops rows by value to this pipeline stage.</p>
<dl class="simple">
<dt>values<span class="classifier">list-like</span></dt><dd><p>A list of the values to drop.</p>
</dd>
<dt>columns<span class="classifier">str or list-like, default None</span></dt><dd><p>The name, or an iterable of names, of columns to check for the given
values. If set to None, all columns are checked.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">18</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ValDrop</span><span class="p">([</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">    a   b</span>
<span class="go">1   1   4</span>
<span class="go">3  18  11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ValDrop</span><span class="p">([</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">    a   b</span>
<span class="go">3  18  11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">ValKeep</code><span class="sig-paren">(</span><em class="sig-param">values</em>, <em class="sig-param">columns=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Creates and adds a pipeline stage that keeps rows by value to this pipeline stage.</p>
<dl class="simple">
<dt>values<span class="classifier">list-like</span></dt><dd><p>A list of the values to keep.</p>
</dd>
<dt>columns<span class="classifier">str or list-like, default None</span></dt><dd><p>The name, or an iterable of names, of columns to check for the given
values. If set to None, all columns are checked.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">pdpipe</span> <span class="k">as</span> <span class="nn">pdp</span><span class="p">;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ValKeep</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a   b</span>
<span class="go">2  4   5</span>
<span class="go">3  5  11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdp</span><span class="o">.</span><span class="n">ValKeep</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a  b</span>
<span class="go">2  4  5</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/universe.jpg" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Universe</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dummy_class_template_for_your_next_project.html">This is a template for including classes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pdpipe.core.make_pdpipeline.html">make_pdpipeline</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="pdpipe.core.AdHocStage.html">AdHocStage</a></li>
<li class="toctree-l1"><a class="reference internal" href="pdpipe.core.PdPipeline.html">PdPipeline</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PdPipelineStage</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pdpipe.core.PdPipeline.html" title="PdPipeline"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pdpipe  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Shay Palachy.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.2.
    </div>
  </body>
</html>